<!DOCTYPE html>
<html lang="zh-CN">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
        <title>ä¿¡æ¯å®‰å…¨æŠ€æœ¯å…¥é—¨ - Fog&#39;s Blog</title><meta name="Description" content="Technology sharing"><meta property="og:title" content="ä¿¡æ¯å®‰å…¨æŠ€æœ¯å…¥é—¨" />
<meta property="og:description" content="è°ˆåˆ°ä¿¡æ¯å®‰å…¨ï¼Œæˆ‘åªèƒ½ç®—æ˜¯ä¸ªé—¨å¤–æ±‰ã€‚ä½†æ˜¯ç”±äºå·¥ä½œéœ€æ±‚ï¼Œç»å¸¸ä¹Ÿä¼šæ¥è§¦ä¸€äº›ï¼Œæ‰€ä»¥æ•´ç†ä¸€ä¸‹å¤‡æŸ¥ã€‚é¡ºä¾¿ä¹ŸæŠŠè‡ªå·±çš„ä¸€äº›å¿ƒå¾—åˆ†äº«å‡ºæ¥ã€‚ å…³é”®å­— æˆ‘ä»¬åœ¨çœ‹è·Ÿå®‰å…¨" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://f0ghua.github.io/security/" /><meta property="og:image" content="https://f0ghua.github.io/logo.png"/><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-07-01T09:11:00+08:00" />
<meta property="article:modified_time" content="2022-07-05T17:24:59+08:00" />

<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://f0ghua.github.io/logo.png"/>

<meta name="twitter:title" content="ä¿¡æ¯å®‰å…¨æŠ€æœ¯å…¥é—¨"/>
<meta name="twitter:description" content="è°ˆåˆ°ä¿¡æ¯å®‰å…¨ï¼Œæˆ‘åªèƒ½ç®—æ˜¯ä¸ªé—¨å¤–æ±‰ã€‚ä½†æ˜¯ç”±äºå·¥ä½œéœ€æ±‚ï¼Œç»å¸¸ä¹Ÿä¼šæ¥è§¦ä¸€äº›ï¼Œæ‰€ä»¥æ•´ç†ä¸€ä¸‹å¤‡æŸ¥ã€‚é¡ºä¾¿ä¹ŸæŠŠè‡ªå·±çš„ä¸€äº›å¿ƒå¾—åˆ†äº«å‡ºæ¥ã€‚ å…³é”®å­— æˆ‘ä»¬åœ¨çœ‹è·Ÿå®‰å…¨"/>
<meta name="application-name" content="Fog&#39;s Blog">
<meta name="apple-mobile-web-app-title" content="Fog&#39;s Blog"><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="https://f0ghua.github.io/security/" /><link rel="prev" href="https://f0ghua.github.io/strncpy/" /><link rel="next" href="https://f0ghua.github.io/linux_proc/" /><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/normalize.css@8.0.1/normalize.min.css"><link rel="stylesheet" href="/css/style.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.13.0/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.7.2/animate.min.css"><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "ä¿¡æ¯å®‰å…¨æŠ€æœ¯å…¥é—¨",
        "inLanguage": "zh-CN",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/f0ghua.github.io\/security\/"
        },"image": ["https:\/\/f0ghua.github.io\/images\/Apple-Devices-Preview.png"],"genre": "posts","wordcount":  3071 ,
        "url": "https:\/\/f0ghua.github.io\/security\/","datePublished": "2022-07-01T09:11:00+08:00","dateModified": "2022-07-05T17:24:59+08:00","license": "This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.","publisher": {
            "@type": "Organization",
            "name": "xxxx","logo": "https:\/\/f0ghua.github.io\/images\/avatar.png"},"author": {
                "@type": "Person",
                "name": "fog"
            },"description": ""
    }
    </script></head>
    <body header-desktop="fixed" header-mobile="auto"><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('auto' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'auto' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="Fog&#39;s Blog"><span class="header-title-pre"><i class='far fa-kiss-wink-heart fa-fw'></i></span>Fog&#39;s Blog</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/posts/"> æ‰€æœ‰æ–‡ç«  </a><a class="menu-item" href="/tags/"> æ ‡ç­¾ </a><a class="menu-item" href="/categories/"> åˆ†ç±» </a><a class="menu-item" href="/categories/documentation/"> æ–‡æ¡£ </a><a class="menu-item" href="/about/"> å…³äº </a><a class="menu-item" href="https://github.com/dillonzq/LoveIt" title="GitHub" rel="noopener noreffer" target="_blank"><i class='fab fa-github fa-fw'></i>  </a><span class="menu-item delimiter"></span><a href="javascript:void(0);" class="menu-item language" title="é€‰æ‹©è¯­è¨€">ç®€ä½“ä¸­æ–‡<i class="fas fa-chevron-right fa-fw"></i>
                        <select class="language-select" id="language-select-desktop" onchange="location = this.value;"><option value="/security/" selected>ç®€ä½“ä¸­æ–‡</option></select>
                    </a><span class="menu-item search" id="search-desktop">
                        <input type="text" placeholder="æœç´¢æ–‡ç« æ ‡é¢˜æˆ–å†…å®¹..." id="search-input-desktop">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="æœç´¢">
                            <i class="fas fa-search fa-fw"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="æ¸…ç©º">
                            <i class="fas fa-times-circle fa-fw"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-desktop">
                            <i class="fas fa-spinner fa-fw fa-spin"></i>
                        </span>
                    </span><a href="javascript:void(0);" class="menu-item theme-switch" title="åˆ‡æ¢ä¸»é¢˜">
                    <i class="fas fa-adjust fa-fw"></i>
                </a>
            </div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="Fog&#39;s Blog"><span class="header-title-pre"><i class='far fa-kiss-wink-heart fa-fw'></i></span>Fog&#39;s Blog</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><div class="search-wrapper">
                    <div class="search mobile" id="search-mobile">
                        <input type="text" placeholder="æœç´¢æ–‡ç« æ ‡é¢˜æˆ–å†…å®¹..." id="search-input-mobile">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="æœç´¢">
                            <i class="fas fa-search fa-fw"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="æ¸…ç©º">
                            <i class="fas fa-times-circle fa-fw"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-mobile">
                            <i class="fas fa-spinner fa-fw fa-spin"></i>
                        </span>
                    </div>
                    <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
                        å–æ¶ˆ
                    </a>
                </div><a class="menu-item" href="/posts/" title="">æ‰€æœ‰æ–‡ç« </a><a class="menu-item" href="/tags/" title="">æ ‡ç­¾</a><a class="menu-item" href="/categories/" title="">åˆ†ç±»</a><a class="menu-item" href="/categories/documentation/" title="">æ–‡æ¡£</a><a class="menu-item" href="/about/" title="">å…³äº</a><a class="menu-item" href="https://github.com/dillonzq/LoveIt" title="GitHub" rel="noopener noreffer" target="_blank"><i class='fab fa-github fa-fw'></i></a><a href="javascript:void(0);" class="menu-item theme-switch" title="åˆ‡æ¢ä¸»é¢˜">
                <i class="fas fa-adjust fa-fw"></i>
            </a><a href="javascript:void(0);" class="menu-item" title="é€‰æ‹©è¯­è¨€">ç®€ä½“ä¸­æ–‡<i class="fas fa-chevron-right fa-fw"></i>
                    <select class="language-select" onchange="location = this.value;"><option value="/security/" selected>ç®€ä½“ä¸­æ–‡</option></select>
                </a></div>
    </div>
</header>
<div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
</div>
<div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
</div>
<main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">ç›®å½•</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animated flipInX">ä¿¡æ¯å®‰å…¨æŠ€æœ¯å…¥é—¨</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="/" title="Author" rel=" author" class="author"><i class="fas fa-user-circle fa-fw"></i>fog</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime="2022-07-01">2022-07-01</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;çº¦ 3071 å­—&nbsp;
                <i class="far fa-clock fa-fw"></i>&nbsp;é¢„è®¡é˜…è¯» 7 åˆ†é’Ÿ&nbsp;</div>
        </div><div class="details toc" id="toc-static"  kept="">
                <div class="details-summary toc-title">
                    <span>ç›®å½•</span>
                    <span><i class="details-icon fas fa-angle-right"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#å…³é”®å­—">å…³é”®å­—</a></li>
    <li><a href="#ç›¸å…³æŠ€æœ¯">ç›¸å…³æŠ€æœ¯</a>
      <ul>
        <li><a href="#å¯¹ç§°åŠ å¯†ç®—æ³•">å¯¹ç§°åŠ å¯†ç®—æ³•</a></li>
        <li><a href="#éå¯¹ç§°åŠ å¯†ç®—æ³•-å…¬é’¥åŠ å¯†">éå¯¹ç§°åŠ å¯†ç®—æ³•ï¼ˆå…¬é’¥åŠ å¯†ï¼‰</a></li>
        <li><a href="#pki">PKI</a>
          <ul>
            <li><a href="#ca">CA</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#å®ä¾‹è¯´æ˜">å®ä¾‹è¯´æ˜</a>
      <ul>
        <li><a href="#pki">PKI</a>
          <ul>
            <li><a href="#ç”Ÿæˆ-ca-çš„ç§é’¥">ç”Ÿæˆ CA çš„ç§é’¥</a></li>
            <li><a href="#ç”Ÿæˆ-ca-çš„è‡ªæˆ‘ç­¾åè¯ä¹¦">ç”Ÿæˆ CA çš„è‡ªæˆ‘ç­¾åè¯ä¹¦</a></li>
            <li><a href="#ç”Ÿæˆç”¨æˆ·çš„ç§æœ‰å¯†é’¥">ç”Ÿæˆç”¨æˆ·çš„ç§æœ‰å¯†é’¥</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#reference">Reference</a></li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><p>è°ˆåˆ°ä¿¡æ¯å®‰å…¨ï¼Œæˆ‘åªèƒ½ç®—æ˜¯ä¸ªé—¨å¤–æ±‰ã€‚ä½†æ˜¯ç”±äºå·¥ä½œéœ€æ±‚ï¼Œç»å¸¸ä¹Ÿä¼šæ¥è§¦ä¸€äº›ï¼Œæ‰€ä»¥æ•´ç†ä¸€ä¸‹å¤‡æŸ¥ã€‚é¡ºä¾¿ä¹ŸæŠŠè‡ªå·±çš„ä¸€äº›å¿ƒå¾—åˆ†äº«å‡ºæ¥ã€‚</p>
<h2 id="å…³é”®å­—">å…³é”®å­—</h2>
<p>æˆ‘ä»¬åœ¨çœ‹è·Ÿå®‰å…¨ç›¸å…³çš„æ–‡çŒ®çš„æ—¶å€™ï¼Œæœ€å¸¸çœ‹åˆ°çš„å°±æ˜¯ä»¥ä¸‹çš„ä¸€äº›è¯æ±‡ã€‚ç†è§£å®ƒä»¬å¯¹äºç†è§£ç›¸å…³æŠ€æœ¯æ˜¯å¾ˆé‡è¦çš„ã€‚</p>
<ul>
<li>Confidentiality ä¿å¯†æ€§</li>
<li>Encrypt åŠ å¯†</li>
<li>Integrity å®Œæ•´æ€§ï¼ˆä½ æœ‰æ²¡æœ‰è¢«ç¯¡æ”¹è¿‡ï¼Ÿï¼‰</li>
<li>Authentication è®¤è¯ï¼ˆä½ æ˜¯è°ï¼Ÿï¼‰</li>
</ul>
<h2 id="ç›¸å…³æŠ€æœ¯">ç›¸å…³æŠ€æœ¯</h2>
<p>æ‰€æœ‰çš„æŠ€æœ¯éƒ½æ˜¯ä¸ºäº†æ»¡è¶³åº”ç”¨çš„éœ€æ±‚è€Œäº§ç”Ÿã€‚å®‰å…¨æŠ€æœ¯ä¹Ÿä¸ä¾‹å¤–ã€‚</p>
<h3 id="å¯¹ç§°åŠ å¯†ç®—æ³•">å¯¹ç§°åŠ å¯†ç®—æ³•</h3>
<p>è€ƒè™‘ä¸€ä¸ªåœºæ™¯ã€‚A æ˜¯ä¸€ä¸ªåœ°ä¸‹å·¥ä½œè€…ï¼Œæ¯éš”ä¸€æ®µæ—¶é—´ï¼Œä»–éƒ½è¦å’Œè‡ªå·±çš„ä¸Šçº¿ B è”ç³»ä¼ é€’ä¿¡æ¯ã€‚ä¸ºäº†ä¿è¯ä¿¡æ¯ä¸è¢«çªƒå¬ï¼ŒA éœ€è¦æŠŠè‡ªå·±çš„ä¿¡æ¯åŠ å¯†ä¹‹åå†å‘é€ç»™ Bï¼Œè€Œ B è¦åšçš„å°±æ˜¯è§£å¯†å¹¶æŸ¥çœ‹ A ç»™ä»–çš„ä¿¡æ¯ã€‚ä¹‹å B åŒæ ·çš„ä¹Ÿå¯ä»¥åŠ å¯†è‡ªå·±çš„ä¿¡æ¯å†ä¼ é€’ç»™ Aã€‚</p>
<p>è¿™é‡Œç”¨åˆ°çš„åŠ è§£å¯†ï¼Œæœ€å¸¸ç”¨çš„æ–¹å¼å°±æ˜¯å¯¹ç§°å¼çš„åŠ å¯†ç®—æ³•äº†ã€‚ä¹Ÿå°±æ˜¯åŒæ–¹éƒ½æ‹¥æœ‰ä¸€ä¸ªç›¸åŒçš„ç§˜é’¥ï¼ˆkeyï¼‰ï¼Œç„¶åä½¿ç”¨ç›¸åŒçš„ç®—æ³•æ¥åŠ å¯†æˆ–è€…è§£å¯†ï¼Œæœ€ç»ˆè·å¾—æ˜æ–‡ã€‚</p>
<p>è¿™æ ·çš„åŠ å¯†ç®—æ³•æœ‰å¾ˆå¤šï¼Œé€šè¿‡ <code>man openssl -&gt; Encoding and Cipher Commands</code> å¯ä»¥çœ‹åˆ°ä¸€äº›å¸¸ç”¨çš„ç®—æ³•åˆ—è¡¨ã€‚</p>
<h3 id="éå¯¹ç§°åŠ å¯†ç®—æ³•-å…¬é’¥åŠ å¯†">éå¯¹ç§°åŠ å¯†ç®—æ³•ï¼ˆå…¬é’¥åŠ å¯†ï¼‰</h3>
<p>è¿™æ ·çš„æ–¹å¼å¾ˆç®€ä¾¿å¿«æ·ï¼Œä½†æ˜¯å­˜åœ¨ä¸€ä¸ªé—®é¢˜ã€‚é‚£å°±æ˜¯ A çš„ç§˜é’¥æ¯æ¬¡æ›´æ–°çš„æ—¶å€™éƒ½å¿…é¡»é€šçŸ¥ B
ä»¥è¿›è¡ŒåŒæ­¥ã€‚è¿™ä¸ªé€šçŸ¥çš„è¿‡ç¨‹å°±å­˜åœ¨ç€çš„æ³„æ¼çš„é£é™©ã€‚</p>
<p>äºæ˜¯ A B åœ¨å•†é‡ä¹‹åæ›´æ–°äº†ä»–ä»¬çš„åŠ å¯†ç­–ç•¥ï¼Œé‡‡ç”¨äº†å…¬é’¥åŠ å¯†ç®—æ³•ã€‚</p>
<p>å…¬é’¥åŠ å¯†ç®—æ³•å’Œå¯¹ç§°åŠ å¯†ç®—æ³•ä¸åŒï¼ŒåŒ…å«äº† 2 ä¸ª keyã€‚ä¸€ä¸ªç§é’¥ï¼ˆprivate keyï¼‰å’Œä¸€ä¸ªå…¬é’¥ï¼ˆpublic keyï¼‰ã€‚å…¬é’¥å¯ä»¥å…¬å¼€å‘å¸ƒï¼Œç”¨æ¥åŠ å¯†ä¿¡æ¯ï¼›è€Œç§é’¥åªä¼šå¦¥å–„ä¿å­˜å¥½ï¼Œç”¨æ¥è§£å¯†å…¬é’¥åŠ å¯†çš„ä¿¡æ¯ã€‚å› ä¸ºç§é’¥ä¸ä¼šè¢«ä¼ æ’­ï¼Œæ‰€ä»¥å°±è§£å†³äº†å¯¹ç§°æ€§åŠ å¯†å¸¦æ¥çš„ç§˜é’¥æ³„æ¼çš„é£é™©ã€‚æ³¨æ„ï¼Œè™½ç„¶ä¸€èˆ¬æƒ…å†µä¸‹æˆ‘ä»¬éƒ½æ˜¯ç”¨å…¬é’¥åŠ å¯†ç§é’¥è§£å¯†ï¼Œä½†æ˜¯é€†è¿‡æ¥ä¹Ÿæ˜¯å¯è¡Œçš„ã€‚ç§é’¥åŠ å¯†çš„ä¿¡æ¯ï¼Œä½¿ç”¨å…¬é’¥åŒæ ·å¯ä»¥è§£å¯†ã€‚</p>
<p>æ¯”è¾ƒå…¸å‹çš„éå¯¹ç§°åŠ å¯†ç®—æ³•å°±æ˜¯ RSA äº†ã€‚</p>
<h3 id="pki">PKI</h3>
<p>ä½†æ˜¯æ€ä¹ˆç¡®å®š B æ‹¿åˆ°çš„å…¬é’¥æ˜¯å±äº A çš„å‘¢ï¼Ÿå¦‚æœä¸­é—´æœ‰äººå·å·æŠŠ A å‘ç»™ B çš„å…¬é’¥æ¢æ‰äº†ï¼Œé‚£ä¸å°±å¯ä»¥ä¼ªè£…æˆ A äº†å—ï¼Ÿ</p>
<p>PKI éš†é‡ç™»åœºã€‚PKI ä¸­æ–‡è¯‘ä¸ºå…¬é’¥åŸºç¡€è®¾æ–½ï¼Œå®ƒæ˜¯è‹±æ–‡ Public Key Infrastructure çš„ç¼©å†™ï¼ŒåŸºäºå…¬é’¥å¯†ç å­¦ï¼Œå»ºç«‹èµ·ä¸€ç§æ™®éé€‚ç”¨çš„åŸºç¡€è®¾æ–½ï¼Œä¸ºå„ç§ç½‘ç»œåº”ç”¨æä¾›å…¨é¢çš„å®‰å…¨æœåŠ¡ã€‚</p>
<p>æˆ‘ä»¬å¯ä»¥ç®€å•çš„è®¤ä¸º PKI ä½“ç³»å°±æ˜¯ä¸ºäº†æ²Ÿé€šçš„åŒæ–¹å®‰å…¨çš„æ‹¿åˆ°å¯¹æ–¹çš„ç§˜é’¥ï¼ˆçœŸå®ï¼Œå®Œæ•´ï¼‰ã€‚</p>
<p>PKI åŸºæœ¬ç»“æ„ç”±è¯ä¹¦è®¤è¯æœºæ„ï¼ˆcertificate authority, CAï¼‰ã€è¯ä¹¦æŒæœ‰è€…ï¼ˆcertificate
holderï¼‰ã€ä¾èµ–æ–¹ï¼ˆrelying partyï¼‰ä¸‰æ–¹æ„æˆ</p>
<ul>
<li>
<p>CA æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„å¯ä¿¡ç¬¬ä¸‰æ–¹ï¼Œä¸ºè¯ä¹¦æŒæœ‰è€…ç­¾å‘æ•°å­—è¯ä¹¦ï¼Œæ•°å­—è¯ä¹¦ä¸­å£°æ˜äº†è¯ä¹¦æŒæœ‰è€…çš„èº«ä»½å’Œå…¬é’¥ã€‚CA åœ¨ç­¾å‘è¯ä¹¦å‰åº”å¯¹è¯ä¹¦æŒæœ‰è€…çš„èº«ä»½ä¿¡æ¯è¿›è¡Œæ ¸å®éªŒè¯ï¼Œå¹¶æ ¹æ®å…¶æ ¸éªŒç»“æœä¸ºå…¶ç­¾å‘è¯ä¹¦ã€‚</p>
</li>
<li>
<p>è¯ä¹¦æŒæœ‰è€…å‘ CA ç”³è¯·æ•°å­—è¯ä¹¦ï¼Œå¹¶å‘ CA æä¾›å¿…è¦çš„ä¿¡æ¯ä»¥è¯æ˜å…¶èº«ä»½åŠèƒ½åŠ›ï¼Œè·å¾—ç”±
CA ç­¾å‘çš„è¯ä¹¦ï¼›è¯ä¹¦æŒæœ‰è€…åœ¨ä¸ä¾èµ–æ–¹è¿›è¡Œäº¤äº’æ—¶ï¼Œéœ€å‘ä¾èµ–æ–¹æä¾›ç”± CA ç­¾å‘çš„æ•°å­—è¯ä¹¦è¯æ˜å…¶æœ‰æ•ˆèº«ä»½ã€‚</p>
</li>
<li>
<p>ä¾èµ–æ–¹æ˜¯è¯ä¹¦çš„éªŒè¯æ–¹ï¼Œä¾èµ–æ–¹ä¸è¯ä¹¦æŒæœ‰è€…è¿›è¡Œäº¤äº’ï¼ˆå¦‚å»ºç«‹é€šä¿¡è¿æ¥ï¼‰æ—¶ï¼Œéœ€è·å–è¯ä¹¦æŒæœ‰è€…çš„æ•°å­—è¯ä¹¦ï¼ŒéªŒè¯æ•°å­—è¯ä¹¦çš„çœŸå®æ€§å’Œæœ‰æ•ˆæ€§ã€‚ä¾èµ–æ–¹å¯ä»¥æŒ‡å®šå…¶ä¿¡ä»»çš„ CA åˆ—è¡¨ï¼Œè‹¥è¯ä¹¦æŒæœ‰è€…æä¾›çš„æ•°å­—è¯ä¹¦ä¸æ˜¯å—ä¿¡ CA ç­¾å‘çš„æ•°å­—è¯ä¹¦ï¼Œä¾èµ–æ–¹å°†ä¸è®¤å¯è¯¥è¯ä¹¦æ‰€å£°æ˜çš„ä¿¡æ¯ã€‚</p>
</li>
</ul>
<p>æ‰€ä»¥ä¸‰è€…çš„å…³ç³»ï¼Œç®€å•æ¥è¯´å°±å¦‚ä¸‹å›¾ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash">
                         +--------------+
               +-----&gt;   <span class="p">|</span>      CA      <span class="p">|</span> &lt;----+
               <span class="p">|</span> +----+  +--------------+      <span class="p">|</span>
       request <span class="p">|</span> <span class="p">|</span> identify                    <span class="p">|</span>
   certficiate <span class="p">|</span> <span class="p">|</span> issue certificate           <span class="p">|</span> trust
               <span class="p">|</span> <span class="p">|</span>                             <span class="p">|</span>
               <span class="p">|</span> v                             <span class="p">|</span>
               <span class="p">|</span>            provide            <span class="p">|</span>
           +-------------+  certificate +-------------+
           <span class="p">|</span> certificate <span class="p">|</span> +---------&gt;  <span class="p">|</span> relay party <span class="p">|</span>
           <span class="p">|</span> holder      <span class="p">|</span> &lt;---------+  <span class="p">|</span>             <span class="p">|</span>
           +-------------+  verifiy     +-------------+
                            certificate

</code></pre></td></tr></table>
</div>
</div><p>è¯ä¹¦å­˜åœ¨çš„æ„ä¹‰åœ¨äºå›ç­”â€œå…¬é’¥å±äºè°â€çš„é—®é¢˜ï¼Œä»¥å¸®åŠ©ç”¨æˆ·å®‰å…¨åœ°è·å¾—å¯¹æ–¹çš„å…¬å¼€å¯†é’¥ã€‚</p>
<p>åœ¨ç†è§£äº† PKI ä¹‹åï¼Œæˆ‘ä»¬å†æ¥çœ‹ A B å¯ä»¥å¦‚ä½•äº¤äº’</p>
<ul>
<li>ç§é’¥(key - private key)</li>
<li>è¯ä¹¦è¯·æ±‚(csr - certificate signing request)</li>
<li>ç­¾åè¯ä¹¦(crt - certificate signed request)</li>
</ul>
<!--listend-->
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash">
                    A                      CA        B

                    +                       +        +
                    <span class="p">|</span>                       <span class="p">|</span>        <span class="p">|</span>
   generate a pair  <span class="p">|</span>                       <span class="p">|</span>        <span class="p">|</span>
           of keys  <span class="p">|</span>                       <span class="p">|</span>        <span class="p">|</span>
                    <span class="p">|</span>  send csr             <span class="p">|</span>        <span class="p">|</span>
                    <span class="p">|</span> +-------------------&gt; <span class="p">|</span>        <span class="p">|</span>
                    <span class="p">|</span>                       <span class="p">|</span>        <span class="p">|</span>
                    <span class="p">|</span>  1. verify identity   <span class="p">|</span>        <span class="p">|</span>
                    <span class="p">|</span>  2. sign the csr      <span class="p">|</span>        <span class="p">|</span>
                    <span class="p">|</span>  3. send back the cer <span class="p">|</span>        <span class="p">|</span>
                    <span class="p">|</span> &lt;-------------------+ <span class="p">|</span>        <span class="p">|</span>
                    <span class="p">|</span>                       <span class="p">|</span>        <span class="p">|</span>
                    <span class="p">|</span>                       <span class="p">|</span>        <span class="p">|</span>
                    <span class="p">|</span>  send A<span class="s1">&#39;s crt to B    |        |
</span><span class="s1">                    | +----------------------------&gt; | 1. verify with CA&#39;</span>s cert
                    <span class="p">|</span>                       <span class="p">|</span>        <span class="p">|</span> 2. store A<span class="s1">&#39;s public key
</span><span class="s1">                    |                       |        |
</span><span class="s1">                    |                       |        |
</span><span class="s1">                    |         send data to A|        |
</span><span class="s1">   decrypt with A&#39;</span>s <span class="p">|</span> &lt;----------------------------+ <span class="p">|</span> encrypt data with
        private key <span class="p">|</span>                       <span class="p">|</span>        <span class="p">|</span> A<span class="err">&#39;</span>s public key
                    <span class="p">|</span>                       <span class="p">|</span>        <span class="p">|</span>
                    <span class="p">|</span>                       <span class="p">|</span>        <span class="p">|</span>
                    <span class="p">|</span>                       <span class="p">|</span>        <span class="p">|</span>
                    <span class="p">|</span>                       <span class="p">|</span>        <span class="p">|</span>
                    +                       +        +

</code></pre></td></tr></table>
</div>
</div><p>å›¾ç¤ºåªæ ‡æ³¨äº† B å¾€ A å‘é€æ•°æ®çš„è¿‡ç¨‹ï¼Œå¦‚æœæ˜¯ A å¾€ B ä¼ é€’ä¿¡æ¯ï¼Œé‚£ä¹ˆåŒæ ·çš„æ–¹æ³•ï¼Œåªæ˜¯æ¢æˆä½¿ç”¨
B çš„ key è€Œå·²ã€‚</p>
<p>åœ¨è¿™é‡Œé¢è¿˜æœ‰å‡ ç‚¹éœ€è¦è¯´æ˜çš„</p>
<ul>
<li>æ‰€è°“çš„ç­¾åï¼Œå…¶å®å¯ä»¥ç®€å•çš„ç†è§£æˆæŠŠåŸå§‹è¯ä¹¦å…ˆåš hashï¼Œå†ä½¿ç”¨ CA çš„ private key
å¯¹è¿™ä¸ª hash å€¼è¿›è¡ŒåŠ å¯†ï¼Œæœ€åæ·»åŠ åˆ°è¯ä¹¦é‡Œé¢çš„ä¸€ä¸ªè¿‡ç¨‹</li>
<li>è¯ä¹¦å¯ä»¥ç”± CA ç­¾åï¼Œä¹Ÿå¯ä»¥è‡ªç­¾å</li>
<li>è¯ä¹¦ä¸€èˆ¬ä½¿ç”¨ X509 çš„æ ¼å¼ï¼Œå…¶ä¸­ä¸­åŒ…å«äº†æŒæœ‰è€…çš„å…¬é’¥å’Œå‘å¸ƒè€…çš„ç­¾åï¼Œä»¥åŠå…¶ä»–çš„ä¸€äº›è¡¨æ˜è¯ä¹¦èº«ä»½ç›¸å…³çš„ä¿¡æ¯</li>
</ul>
<h4 id="ca">CA</h4>
<p>CA åˆ†ä¸º Signed CA å’Œ Self Signed CAã€‚ä¸¤è€…çš„å·®åˆ«åœ¨äºå…¶è¯ä¹¦ï¼ˆcertificateï¼‰è¢«è®¤è¯çš„æ–¹å¼ä¸åŒã€‚</p>
<p>Self Signed CA æ˜¯æŒ‡ç”±è‡ªå·±ç»™è‡ªå·±çš„ certificate åšç­¾åè®¤è¯çš„ CA ï¼Œç”±äºä¸€èˆ¬æ¥è®²æ­¤ç±»
CA æ€»æ˜¯å¤„äº CA é“¾çš„æœ€é¡¶ç«¯ï¼Œæ‰€ä»¥åˆå« Root CAã€‚</p>
<p>Signed CA æ˜¯æŒ‡ certificate ç”±å…¶ä»– CA è¿›è¡Œç­¾åè®¤è¯çš„ CAã€‚è€Œè®¤è¯å®ƒçš„ CAï¼Œæˆ‘ä»¬ç§°ä¸º
Signed CA çš„ä¸Šå±‚ CAï¼Œä¹Ÿå« Parent CAï¼›è€Œ Signed CA åˆ™ç§°ä¸º Sub CA æˆ– Child CAã€‚</p>
<h2 id="å®ä¾‹è¯´æ˜">å®ä¾‹è¯´æ˜</h2>
<h3 id="pki">PKI</h3>
<p>ä¸‹é¢ï¼Œå°±ç”¨ openssl ä¸¾ä¾‹ç”Ÿæˆ RSA çš„ CA å’Œç”¨æˆ·è¯ä¹¦ã€‚</p>
<h4 id="ç”Ÿæˆ-ca-çš„ç§é’¥">ç”Ÿæˆ CA çš„ç§é’¥</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[</span>fog@fog-ibm ca<span class="o">]</span> openssl genrsa -des3 -out ca.key <span class="m">1024</span>

Generating RSA private key, <span class="m">1024</span> bit long modulus
...........................+++++
............................................+++++
e is <span class="m">65537</span> <span class="o">(</span>0x10001<span class="o">)</span>
Enter PEM pass phrase:
Verifying password - Enter PEM pass phrase:

Please backup this ca.key file and remember the pass-phrase you had to
enter at a secure location.
</code></pre></td></tr></table>
</div>
</div><h4 id="ç”Ÿæˆ-ca-çš„è‡ªæˆ‘ç­¾åè¯ä¹¦">ç”Ÿæˆ CA çš„è‡ªæˆ‘ç­¾åè¯ä¹¦</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash">fog@tmp$ openssl req -new -x509 -days <span class="m">365</span> -key ca.key -out ca.crt
Enter pass phrase <span class="k">for</span> ca.key:
You are about to be asked to enter information that will be incorporated
into your certificate request.
What you are about to enter is what is called a Distinguished Name or a DN.
There are quite a few fields but you can leave some blank
For some fields there will be a default value,
If you enter <span class="s1">&#39;.&#39;</span>, the field will be left blank.
-----
Country Name <span class="o">(</span><span class="m">2</span> letter code<span class="o">)</span> <span class="o">[</span>AU<span class="o">]</span>:
State or Province Name <span class="o">(</span>full name<span class="o">)</span> <span class="o">[</span>Some-State<span class="o">]</span>:
Locality Name <span class="o">(</span>eg, city<span class="o">)</span> <span class="o">[]</span>:
Organization Name <span class="o">(</span>eg, company<span class="o">)</span> <span class="o">[</span>Internet Widgits Pty Ltd<span class="o">]</span>:
Organizational Unit Name <span class="o">(</span>eg, section<span class="o">)</span> <span class="o">[]</span>:
Common Name <span class="o">(</span>e.g. server FQDN or YOUR name<span class="o">)</span> <span class="o">[]</span>:Fog
Email Address <span class="o">[]</span>:
</code></pre></td></tr></table>
</div>
</div><p>æŸ¥çœ‹ä¸€ä¸‹ç”Ÿæˆçš„è¯ä¹¦</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash">fog@tmp$ openssl x509 -noout -text -in ca.crt
Certificate:
    Data:
        Version: <span class="m">3</span> <span class="o">(</span>0x2<span class="o">)</span>
        Serial Number:
            6c:5b:7a:5c:37:e3:1b:2d:99:2d:99:20:79:54:c4:d6:52:9e:20:17
        Signature Algorithm: sha256WithRSAEncryption
        Issuer: <span class="nv">C</span> <span class="o">=</span> AU, <span class="nv">ST</span> <span class="o">=</span> Some-State, <span class="nv">O</span> <span class="o">=</span> Internet Widgits Pty Ltd, <span class="nv">CN</span> <span class="o">=</span> Fog
        Validity
            Not Before: Jul  <span class="m">5</span> 08:43:44 <span class="m">2022</span> GMT
            Not After : Jul  <span class="m">5</span> 08:43:44 <span class="m">2023</span> GMT
        Subject: <span class="nv">C</span> <span class="o">=</span> AU, <span class="nv">ST</span> <span class="o">=</span> Some-State, <span class="nv">O</span> <span class="o">=</span> Internet Widgits Pty Ltd, <span class="nv">CN</span> <span class="o">=</span> Fog
        Subject Public Key Info:
            Public Key Algorithm: rsaEncryption
                RSA Public-Key: <span class="o">(</span><span class="m">1024</span> bit<span class="o">)</span>
                Modulus:
                    00:c2:ad:39:a9:64:a5:85:5b:39:ab:eb:a8:da:82:
                    66:90:60:f9:35:d9:ea:67:4e:6f:d6:99:14:1c:32:
                    6a:23:e4:03:eb:11:44:1a:94:4d:42:a1:74:9e:26:
                    62:10:0b:4b:a8:3c:10:28:32:c9:d9:1b:34:aa:03:
                    5d:d6:63:70:32:68:c0:d2:9d:17:e7:b4:47:6e:6e:
                    86:66:a5:bc:f1:52:4e:2a:47:2a:0e:7b:00:d7:f9:
                    d0:70:c2:12:58ğŸ†df:b3:82:51:23:cf:a8:59:40:
                    c6:a7:7e:f6:8c:91:1e:00:42:87:d1:42:1c:98:15:
                    4e:ff:1c:38:55:8a:d1:9d:fb
                Exponent: <span class="m">65537</span> <span class="o">(</span>0x10001<span class="o">)</span>
        X509v3 extensions:
            X509v3 Subject Key Identifier:
                3F:46:C9:DA:5C:4E:60:65:CB:48:8E:DF:FE:92:67:2C:03:A4:B0:A1
            X509v3 Authority Key Identifier:
                keyid:3F:46:C9:DA:5C:4E:60:65:CB:48:8E:DF:FE:92:67:2C:03:A4:B0:A1

            X509v3 Basic Constraints: critical
                CA:TRUE
    Signature Algorithm: sha256WithRSAEncryption
         72:98:2c:4b:ac:5d:3e:aa:21:ca:5f:46:1a:b9:14:2c:2f:b8:
         e9:3d:8a:bd:19:ea:da:32:13:fc:02:9c:f7:f2:2b:99:56:20:
         11:86:5b:7c:1b:ea:5a:0e:f4:bd:da:e2:44:ec:b9:71:7b:3a:
         01:a3:d1:dc:bc:fc:52:49:6a:c8:f4:2c:27:45:ab:e6:65:bf:
         75:75:1e:66:56:cc:82:71:95:7f:0b:da:8a:bf:2d:b6:7b:fd:
         72:a2:68:f5:13:59:6f:ac:72:20:bf:59:0c:20:60:3d:46:6e:
         d7:4c:83:90:42ğŸ†04:b9:e1:e4:9f:1c:7e:1e:2f:96:32:b0:
         89:6e
</code></pre></td></tr></table>
</div>
</div><p>è¿™é‡Œæˆ‘ä»¬å°±å¯ä»¥çœ‹åˆ°ä¸€ä¸ª x509 æ ¼å¼çš„è¯ä¹¦åŒ…å«äº†å“ªäº›å­—æ®µã€‚è¿™ä¸ªå¯¹äºç†è§£è¯ä¹¦å¾ˆé‡è¦ï¼Œæ‰€ä»¥è¯¦ç»†åˆ†æä¸€ä¸‹</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash">Issuer: <span class="nv">C</span> <span class="o">=</span> AU, <span class="nv">ST</span> <span class="o">=</span> Some-State, <span class="nv">O</span> <span class="o">=</span> Internet Widgits Pty Ltd, <span class="nv">CN</span> <span class="o">=</span> Fog
Subject: <span class="nv">C</span> <span class="o">=</span> AU, <span class="nv">ST</span> <span class="o">=</span> Some-State, <span class="nv">O</span> <span class="o">=</span> Internet Widgits Pty Ltd, <span class="nv">CN</span> <span class="o">=</span> Fog
</code></pre></td></tr></table>
</div>
</div><p>å› ä¸ºè¿™æ˜¯ä¸€ä¸ªè‡ªç­¾åçš„è¯ä¹¦ï¼Œæ‰€ä»¥ Issuer å’Œ Subject çš„å†…å®¹æ˜¯ä¸€æ ·ï¼ˆIssuer è¡¨ç¤ºæ˜¯è°é¢å‘çš„è¯ä¹¦ï¼Œè€Œ Subject è¡¨ç¤ºè¿™ä¸ªè¯ä¹¦å±äºè°ï¼‰ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash">        Subject Public Key Info:
            Public Key Algorithm: rsaEncryption
                RSA Public-Key: <span class="o">(</span><span class="m">1024</span> bit<span class="o">)</span>
</code></pre></td></tr></table>
</div>
</div><p>Public Key Info å‘Šè¯‰æˆ‘ä»¬è¿™ä¸ª Public Key å¯¹åº”çš„åŠ å¯†ç®—æ³•æ˜¯ RSAï¼Œç§˜é’¥ä¸º 1024 bitï¼Œç„¶åæ˜æ–‡é™„ä¸Šäº†å¯¹åº”çš„ç§˜é’¥ï¼ˆæ³¨æ„è¿™æ˜¯ç§˜é’¥å¯¹é‡Œé¢çš„ public keyï¼‰ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash">        X509v3 extensions:
            X509v3 Basic Constraints: critical
                CA:TRUE
</code></pre></td></tr></table>
</div>
</div><p>è¿™é‡Œå¯ä»¥çœ‹åˆ° CA çš„å€¼æ˜¯ TRUEï¼Œè¡¨ç¤ºè¿™ä¸ªè¯ä¹¦å¯ä»¥ä½œä¸º CA è¯ä¹¦ä½¿ç”¨ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash">Signature Algorithm: sha256WithRSAEncryption
</code></pre></td></tr></table>
</div>
</div><p>ç­¾åçš„ç®—æ³•ä¸ºå…ˆç”¨ sha256 åš hash ç®—æ³•ï¼Œç„¶åå†ç”¨ RSA ç®—æ³•ä½¿ç”¨ Issuer çš„ private key
è¿›è¡ŒåŠ å¯†ã€‚</p>
<h4 id="ç”Ÿæˆç”¨æˆ·çš„ç§æœ‰å¯†é’¥">ç”Ÿæˆç”¨æˆ·çš„ç§æœ‰å¯†é’¥</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash">fog@tmp$ openssl genrsa -des3 -out my.key <span class="m">1024</span>
</code></pre></td></tr></table>
</div>
</div><p>ç”Ÿæˆç”¨æˆ·çš„ç­¾åè¯·æ±‚è¯ä¹¦</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash">fog@tmp$ openssl req -new -key my.key -out my.csr
</code></pre></td></tr></table>
</div>
</div><p>ç”± CA ä¸ºè¯·æ±‚è¯ä¹¦ç­¾å</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash">fog@tmp$ openssl x509 -req -CA ca.crt -CAkey ca.key -CAcreateserial -in my.csr -out my.crt -days <span class="m">365</span>
</code></pre></td></tr></table>
</div>
</div><p>ç°åœ¨å†æ¥çœ‹çœ‹è¿™ä¸ªç”Ÿæˆçš„è¯ä¹¦æ˜¯ä»€ä¹ˆæ ·çš„</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash">fog@tmp$ openssl x509 -noout -text -in my.crt
Certificate:
    Data:
        Version: <span class="m">1</span> <span class="o">(</span>0x0<span class="o">)</span>
        Serial Number:
            14:a2:7c:94:fa:b8:0c:28:0d:9b:c3:86:44:3a:cf:40:0e:ea:71:c3
        Signature Algorithm: sha256WithRSAEncryption
        Issuer: <span class="nv">C</span> <span class="o">=</span> AU, <span class="nv">ST</span> <span class="o">=</span> Some-State, <span class="nv">O</span> <span class="o">=</span> Internet Widgits Pty Ltd, <span class="nv">CN</span> <span class="o">=</span> Fog
        Validity
            Not Before: Jul  <span class="m">5</span> 09:10:51 <span class="m">2022</span> GMT
            Not After : Jul  <span class="m">5</span> 09:10:51 <span class="m">2023</span> GMT
        Subject: <span class="nv">C</span> <span class="o">=</span> AU, <span class="nv">ST</span> <span class="o">=</span> Some-State, <span class="nv">O</span> <span class="o">=</span> Internet Widgits Pty Ltd, <span class="nv">CN</span> <span class="o">=</span> User
        Subject Public Key Info:
            Public Key Algorithm: rsaEncryption
                RSA Public-Key: <span class="o">(</span><span class="m">1024</span> bit<span class="o">)</span>
                Modulus:
                    00:bd:8c:96:bb:a7:3f:39:36:61:fa:41:d1:70:42:
                    0f:b8:36:d4:3a:d2:0a:e1:85:f6:fe:25:d7:92:63:
                    e3:a6:72:70:1d:93:e1:69:70:e7:38:7b:32:49:ae:
                    bc:05:8e:9f:00:dd:9a:9c:c9:9b:62:97:a1:4f:c3:
                    09:d8:5c:af:83:fa:fb:1f:fd:a9:32:74:4f:6b:a4:
                    e7:52:d3:8d:bd:2e:1f:11:55:9e:b1:bf:fe:c6:6f:
                    25ğŸ’¿d4:23:10:34:39:26:e2:37:eb:2f:83:84:91:
                    d3:39:b4:d0:e1:4a:ab:c6:fd:96:98:4c:31:9f:b7:
                    17:39:f4:08:09:77:11:51:53
                Exponent: <span class="m">65537</span> <span class="o">(</span>0x10001<span class="o">)</span>
    Signature Algorithm: sha256WithRSAEncryption
         47:dd:5e:81:6a:f1:e8:8d:11:86:3d:4b:6e:30:51:64:af:30:
         d4:e8:0d:c9:5e:07:f0:59:1d:f0:64:b9:e9:76:e1:66:61:59:
         f9:b9:bc:21:92:93:db:13:6e:ec:08:3c:7f:6c:a4:96:a3:9e:
         cf:76:fb:f6:8b:52:34:f4:dd:5f:56:97:df:98:c5:53:6c:97:
         18:ef:8c:ce:09:77:43:27:04:f9:14:b2:4d:a1:7f:38:bb:fe:
         4a:aa:45:1a:c3:f5:c5:46:f7:b8:fb:9a:cd:34:4e:1a:a5:3c:
         28:b0:f7:57:28:7d:85:52:da:0f:48:b2:f5:90:7d:80:fa:76:
         07:20
</code></pre></td></tr></table>
</div>
</div><p>é€šè¿‡ Issuer å’Œ Subject å¯ä»¥çœ‹å‡ºï¼Œè¿™ä¸ªè¯ä¹¦æ˜¯ç”± Fogï¼ˆCAï¼‰é¢å‘ç»™ User çš„ã€‚</p>
<p>å¯¹äº private key å¤§å¤šæ•°æ—¶å€™æˆ‘ä»¬ä¸éœ€è¦å¯†ç ä¿æŠ¤ï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹å‘½ä»¤æ¥å»é™¤å®ƒ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash">fog@tmp$ openssl rsa -in my.key -out myunsecure.key
Enter pass phrase <span class="k">for</span> my.key:
writing RSA key
</code></pre></td></tr></table>
</div>
</div><h2 id="reference">Reference</h2>
<ul>
<li><a href="https://stackoverflow.com/questions/4024393/difference-between-self-signed-ca-and-self-signed-certificate" target="_blank" rel="noopener noreffer">Difference between self-signed CA and self-signed certificate</a></li>
<li><a href="https://www.linux.com/training-tutorials/tls-encryption-and-mutual-authentication-using-syslog-ng-open-source-edition/" target="_blank" rel="noopener noreffer">TLS encryption and mutual authentication using syslog-ng Open Source Edition</a></li>
<li><a href="https://blog.gisspan.com/2016/04/making-sense-of-ssl-rsa-x509-and-csr.html" target="_blank" rel="noopener noreffer">Making sense of SSL, RSA, X509 and CSR</a></li>
<li><a href="https://medium.com/@ebuschini/a-journey-into-verifying-signatures-on-x-509-certificates-168a5bafaa14" target="_blank" rel="noopener noreffer">A journey into verifying signatures on x.509 certificates</a></li>
</ul>
</div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>æ›´æ–°äº 2022-07-05</span>
            </div>
            <div class="post-info-license"></div>
        </div>
        <div class="post-info-line">
            <div class="post-info-md"></div>
            <div class="post-info-share">
                <span><a href="javascript:void(0);" title="åˆ†äº«åˆ° Twitter" data-sharer="twitter" data-url="https://f0ghua.github.io/security/" data-title="ä¿¡æ¯å®‰å…¨æŠ€æœ¯å…¥é—¨"><i class="fab fa-twitter fa-fw"></i></a><a href="javascript:void(0);" title="åˆ†äº«åˆ° Facebook" data-sharer="facebook" data-url="https://f0ghua.github.io/security/"><i class="fab fa-facebook-square fa-fw"></i></a><a href="javascript:void(0);" title="åˆ†äº«åˆ° Hacker News" data-sharer="hackernews" data-url="https://f0ghua.github.io/security/" data-title="ä¿¡æ¯å®‰å…¨æŠ€æœ¯å…¥é—¨"><i class="fab fa-hacker-news fa-fw"></i></a><a href="javascript:void(0);" title="åˆ†äº«åˆ° Line" data-sharer="line" data-url="https://f0ghua.github.io/security/" data-title="ä¿¡æ¯å®‰å…¨æŠ€æœ¯å…¥é—¨"><i data-svg-src="https://cdn.jsdelivr.net/npm/simple-icons@2.14.0/icons/line.svg"></i></a><a href="javascript:void(0);" title="åˆ†äº«åˆ° å¾®åš" data-sharer="weibo" data-url="https://f0ghua.github.io/security/" data-title="ä¿¡æ¯å®‰å…¨æŠ€æœ¯å…¥é—¨"><i class="fab fa-weibo fa-fw"></i></a></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">è¿”å›</a></span>&nbsp;|&nbsp;<span><a href="/">ä¸»é¡µ</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/strncpy/" class="prev" rel="prev" title="C è¯­è¨€å¸¸ç”¨åº“å‡½æ•°-strncpy"><i class="fas fa-angle-left fa-fw"></i>C è¯­è¨€å¸¸ç”¨åº“å‡½æ•°-strncpy</a>
            <a href="/linux_proc/" class="next" rel="next" title="å†…æ ¸ç©ºé—´å’Œç”¨æˆ·ç©ºé—´é€šä¿¡ - proc è™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿ">å†…æ ¸ç©ºé—´å’Œç”¨æˆ·ç©ºé—´é€šä¿¡ - proc è™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿ<i class="fas fa-angle-right fa-fw"></i></a></div>
</div>
<div id="comments"><div id="utterances"></div><noscript>
                Please enable JavaScript to view the comments powered by <a href="https://utteranc.es/">Utterances</a>.
            </noscript></div></article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line"><i class="far fa-copyright fa-fw"></i><span itemprop="copyrightYear">2022 - 2024</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="/" target="_blank">fog</a></span>&nbsp;|&nbsp;<span class="license"><a rel="license external nofollow noopener noreffer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="å›åˆ°é¡¶éƒ¨">
                <i class="fas fa-arrow-up fa-fw"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="æŸ¥çœ‹è¯„è®º">
                <i class="fas fa-comment fa-fw"></i>
            </a>
        </div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery.js@1.2.0/dist/css/lightgallery.min.css"><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/smooth-scroll@16.1.3/dist/smooth-scroll.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/autocomplete.js@0.37.1/dist/autocomplete.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/algoliasearch@4.2.0/dist/algoliasearch-lite.umd.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lazysizes@5.2.2/lazysizes.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lightgallery.js@1.2.0/dist/js/lightgallery.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lg-thumbnail.js@1.2.0/dist/lg-thumbnail.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lg-zoom.js@1.2.0/dist/lg-zoom.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/clipboard@2.0.6/dist/clipboard.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/sharer.js@0.4.0/sharer.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"å¤åˆ¶åˆ°å‰ªè´´æ¿","maxShownLines":10},"comment":{"utterances":{"darkTheme":"github-dark","issueTerm":"pathname","label":"","lightTheme":"github-light","repo":"f0ghua/hugo_comments"}},"lightGallery":{"actualSize":false,"exThumbImage":"data-thumbnail","hideBarsDelay":2000,"selector":".lightgallery","speed":400,"thumbContHeight":80,"thumbWidth":80,"thumbnail":true},"search":{"algoliaAppID":"I9I6IQKZY4","algoliaIndex":"index.cn","algoliaSearchKey":"604ef86245b2a95cadc730cb1dde0244","highlightTag":"em","maxResultLength":10,"noResultsFound":"æ²¡æœ‰æ‰¾åˆ°ç»“æœ","snippetLength":50,"type":"algolia"}};</script><script type="text/javascript" src="/js/theme.min.js"></script></body>
</html>
